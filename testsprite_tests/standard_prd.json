{
  "meta": {
    "project": "Papago Korean→English Transcription & Subtitles",
    "date": "2025-11-04",
    "prepared_by": "Software Development Manager"
  },
  "product_overview": "A transcription and subtitle generation tool that processes Korean audio/video files to generate bilingual Korean-English subtitles using OpenAI Whisper and Papago translation APIs, with styled subtitle burning into videos and a user-friendly interface.",
  "core_goals": [
    "Allow users to upload various audio and video formats for processing.",
    "Accurately transcribe Korean speech using Whisper large-v3 model.",
    "Translate Korean transcriptions into English via Papago API securely using Space Secrets.",
    "Generate bilingual SRT subtitle files with Korean text styled in 16pt blue (#A7C1E8) on top and English text in 15pt white (#FFFFFF) below.",
    "Burn styled subtitles into videos using ASS format and FFmpeg with proper font rendering and styling.",
    "Provide real-time progress feedback and robust error handling with detailed UI messaging.",
    "Ensure usage of NanumGothic font to prevent missing glyphs ('tofu') in Korean subtitles."
  ],
  "key_features": [
    "Support for uploading audio/video file types including mp4, mov, mkv, webm, mp3, and wav.",
    "Integration with OpenAI Whisper large-v3 for high-quality Korean speech transcription.",
    "Usage of Papago translation API with secure credentials management via Hugging Face Space Secrets.",
    "Generation of bilingual SRT subtitle files with customized styling: Korean subtitles in 16pt NanumGothic font colored #A7C1E8 on top line; English subtitles in 15pt white font on bottom line with proper line breaks.",
    "Burning of subtitles into video files using ASS subtitle format and FFmpeg video processing, ensuring font embedding and correct style application.",
    "UI components providing progress updates and clear, user-friendly error messages upon failure in transcription, translation, or video processing.",
    "Deployment on Hugging Face Spaces with pinned dependencies and installation of system packages including ffmpeg and Nanum fonts to ensure runtime consistency."
  ],
  "user_flow_summary": [
    "User uploads an audio or video file through the Gradio-powered UI.",
    "Application processes the file by transcribing Korean speech using Whisper large-v3.",
    "Transcribed Korean text is securely sent to Papago API for English translation using stored client credentials.",
    "A bilingual SRT subtitle file is generated combining Korean and English text with specified styles.",
    "User can download the generated subtitle file and a video file with burned-in styled subtitles.",
    "UI displays the processing progress and any errors encountered during transcription, translation, or subtitle burning stages."
  ],
  "validation_criteria": [
    "Uploading a supported video file (e.g., MP4) results in downloadable bilingual SRT and subtitled video outputs.",
    "Korean subtitle text correctly renders using NanumGothic font without missing glyphs.",
    "Subtitle styling matches specification: Korean text top line in 16pt #A7C1E8, English text bottom line in 15pt white, with proper line breaks and spacing.",
    "Errors from FFmpeg or Papago API failures surface clearly and promptly in the user interface.",
    "Subtitles are accurately burned into the video using FFmpeg with correct font and styling applied.",
    "System uses Space Secrets to securely manage Papago API credentials without exposing them in UI or code.",
    "The application installs and uses necessary fonts and system packages to avoid runtime errors or missing characters in subtitles."
  ],
  "code_summary": {
    "projectName": "Papago Korean→English Transcription & Subtitles",
    "techStack": {
      "language": "Python",
      "runtime": ">=3.10",
      "framework": "Gradio 4.x",
      "ml": [
        "OpenAI Whisper (large-v3)"
      ],
      "video": [
        "FFmpeg"
      ],
      "hosting": "Hugging Face Spaces",
      "fonts": [
        "NanumGothic via fonts-nanum, fonts-nanum-extra"
      ],
      "ci_deploy": [
        "custom sync_to_hf.sh"
      ]
    },
    "dependencies": [
      "gradio",
      "huggingface_hub==0.19.4 (for Gradio compatibility)",
      "openai-whisper",
      "ffmpeg (system)"
    ],
    "secrets": [
      "PAPAGO_CLIENT_ID",
      "PAPAGO_CLIENT_SECRET"
    ],
    "features": [
      "Upload audio/video (.mp4/.mov/.mkv/.webm/.mp3/.wav/etc)",
      "Transcribe Korean speech with Whisper large-v3",
      "Translate to English with Papago API",
      "Generate bilingual SRT (KR top 16pt #A7C1E8, EN bottom 15pt #FFFFFF)",
      "Burn styled subtitles into video using ASS + FFmpeg",
      "Progress feedback and robust error messages in UI",
      "Use Space Secrets for Papago credentials"
    ],
    "keyFiles": {
      "app.py": "Gradio UI, FFmpeg integration, ASS generation, progress, logging",
      "papago_translation.py": "PapagoTranslator, timestamp helpers, SRT generation with inline SSA tags",
      "requirements_hf.txt": "Pinned deps for Space",
      "packages.txt": "System packages (ffmpeg, Nanum fonts)",
      "sync_to_hf.sh": "Deploy script to Space"
    },
    "notableConfigs": {
      "fonts": "NanumGothic installed via packages.txt to avoid tofu squares",
      "subtitleStyle": "KR 16pt #A7C1E8 top; EN 15pt #FFFFFF bottom; \\N between lines; blank line between segments",
      "ffmpegFilter": "subtitles=ASS:charenc=UTF-8:force_style=FontName=NanumGothic,FontSize=16",
      "whisperModel": "large-v3 auto-selected"
    },
    "risks": [
      "FFmpeg filter quoting/escaping across environments",
      "Font discovery issues if fonts not installed",
      "Papago API timeouts or quota",
      "Large Whisper model memory/CPU usage on Space"
    ]
  }
}
